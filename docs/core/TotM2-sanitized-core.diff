--- docs/core/TotM2-sanitized-pre.dump-simpl	2025-09-14 20:04:31
+++ docs/core/TotM2-sanitized-post.dump-simpl	2025-09-14 20:06:18
@@ -1,9 +1,9 @@
 
 ==================== Tidy Core ====================
-2025-09-15 03:04:31.288853 UTC
+2025-09-15 03:06:18.304004 UTC
 
 Result size of Tidy Core
-  = {terms: 6,075, types: 5,849, coercions: 1,020, joins: 39/186}
+  = {terms: 7,677, types: 7,158, coercions: 1,394, joins: 39/265}
 
 -- RHS size: {terms: 7, types: 4, coercions: 0, joins: 0/0}
 $WWon
@@ -67,6 +67,38 @@
                          -> UArray (Int, Int) Word -> Bool)
                         ~R# (IA -> IA -> Bool))
 
+-- RHS size: {terms: 20, types: 11, coercions: 0, joins: 0/0}
+$fEqDirection_$c==
+  = \ a b ->
+      case a of a1 { __DEFAULT ->
+      case b of b1 { __DEFAULT ->
+      case dataToTagSmall# a1 of a# { __DEFAULT ->
+      case dataToTagSmall# b1 of b# { __DEFAULT ->
+      tagToEnum# (==# a# b#)
+      }
+      }
+      }
+      }
+
+-- RHS size: {terms: 24, types: 11, coercions: 0, joins: 0/0}
+$fEqDirection_$c/=
+  = \ eta eta1 ->
+      case eta of a { __DEFAULT ->
+      case eta1 of b { __DEFAULT ->
+      case dataToTagSmall# a of a# { __DEFAULT ->
+      case dataToTagSmall# b of b# { __DEFAULT ->
+      case ==# a# b# of {
+        __DEFAULT -> True;
+        1# -> False
+      }
+      }
+      }
+      }
+      }
+
+-- RHS size: {terms: 3, types: 1, coercions: 0, joins: 0/0}
+$fEqDirection = C:Eq $fEqDirection_$c== $fEqDirection_$c/=
+
 -- RHS size: {terms: 68, types: 46, coercions: 2, joins: 0/0}
 $fEqGame_$c==
   = \ ds ds1 ->
@@ -1282,38 +1314,158 @@
         ($fHashableExc_$chashWithSalt $dHashable)
         ($fHashableExc_$chash $dHashable)
 
--- RHS size: {terms: 20, types: 11, coercions: 0, joins: 0/0}
-$fEqDirection_$c==
-  = \ a b ->
-      case a of a1 { __DEFAULT ->
-      case b of b1 { __DEFAULT ->
-      case dataToTagSmall# a1 of a# { __DEFAULT ->
-      case dataToTagSmall# b1 of b# { __DEFAULT ->
-      tagToEnum# (==# a# b#)
-      }
-      }
-      }
+-- RHS size: {terms: 30, types: 183, coercions: 94, joins: 0/0}
+$fGenericDirection_$cto
+  = \ @x ds ->
+      case ds
+           `cast` <Co:54> :: Rep Direction x
+                             ~R# (:+:)
+                                   (M1 C (MetaCons "DirUp" PrefixI False) U1
+                                    :+: M1 C (MetaCons "DirDown" PrefixI False) U1)
+                                   (M1 C (MetaCons "DirLeft" PrefixI False) U1
+                                    :+: M1 C (MetaCons "DirRight" PrefixI False) U1)
+                                   x
+      of {
+        L1 ds1 ->
+          case ds1 of {
+            L1 ds2 ->
+              case ds2
+                   `cast` <Co:10> :: M1 C (MetaCons "DirUp" PrefixI False) U1 x
+                                     ~R# U1 x
+              of
+              { U1 ->
+              DirUp
+              };
+            R1 ds2 ->
+              case ds2
+                   `cast` <Co:10> :: M1 C (MetaCons "DirDown" PrefixI False) U1 x
+                                     ~R# U1 x
+              of
+              { U1 ->
+              DirDown
+              }
+          };
+        R1 ds1 ->
+          case ds1 of {
+            L1 ds2 ->
+              case ds2
+                   `cast` <Co:10> :: M1 C (MetaCons "DirLeft" PrefixI False) U1 x
+                                     ~R# U1 x
+              of
+              { U1 ->
+              DirLeft
+              };
+            R1 ds2 ->
+              case ds2
+                   `cast` <Co:10> :: M1 C (MetaCons "DirRight" PrefixI False) U1 x
+                                     ~R# U1 x
+              of
+              { U1 ->
+              DirRight
+              }
+          }
       }
 
--- RHS size: {terms: 24, types: 11, coercions: 0, joins: 0/0}
-$fEqDirection_$c/=
-  = \ eta eta1 ->
-      case eta of a { __DEFAULT ->
-      case eta1 of b { __DEFAULT ->
-      case dataToTagSmall# a of a# { __DEFAULT ->
-      case dataToTagSmall# b of b# { __DEFAULT ->
-      case ==# a# b# of {
-        __DEFAULT -> True;
-        1# -> False
+-- RHS size: {terms: 3, types: 23, coercions: 11, joins: 0/0}
+lvl21
+  = \ @x ->
+      L1
+        (U1
+         `cast` <Co:11> :: U1 x
+                           ~R# M1 C (MetaCons "DirUp" PrefixI False) U1 x)
+
+-- RHS size: {terms: 3, types: 44, coercions: 0, joins: 0/0}
+lvl22 = \ @x -> L1 lvl21
+
+-- RHS size: {terms: 3, types: 23, coercions: 11, joins: 0/0}
+lvl23
+  = \ @x ->
+      R1
+        (U1
+         `cast` <Co:11> :: U1 x
+                           ~R# M1 C (MetaCons "DirDown" PrefixI False) U1 x)
+
+-- RHS size: {terms: 3, types: 44, coercions: 0, joins: 0/0}
+lvl24 = \ @x -> L1 lvl23
+
+-- RHS size: {terms: 3, types: 23, coercions: 11, joins: 0/0}
+lvl25
+  = \ @x ->
+      L1
+        (U1
+         `cast` <Co:11> :: U1 x
+                           ~R# M1 C (MetaCons "DirLeft" PrefixI False) U1 x)
+
+-- RHS size: {terms: 3, types: 44, coercions: 0, joins: 0/0}
+lvl26 = \ @x -> R1 lvl25
+
+-- RHS size: {terms: 3, types: 23, coercions: 11, joins: 0/0}
+lvl27
+  = \ @x ->
+      R1
+        (U1
+         `cast` <Co:11> :: U1 x
+                           ~R# M1 C (MetaCons "DirRight" PrefixI False) U1 x)
+
+-- RHS size: {terms: 3, types: 44, coercions: 0, joins: 0/0}
+lvl28 = \ @x -> R1 lvl27
+
+-- RHS size: {terms: 12, types: 7, coercions: 224, joins: 0/0}
+$fGenericDirection_$cfrom
+  = \ @x x1 ->
+      case x1 of {
+        DirUp ->
+          lvl22
+          `cast` <Co:56> :: (:+:)
+                              (M1 C (MetaCons "DirUp" PrefixI False) U1
+                               :+: M1 C (MetaCons "DirDown" PrefixI False) U1)
+                              (M1 C (MetaCons "DirLeft" PrefixI False) U1
+                               :+: M1 C (MetaCons "DirRight" PrefixI False) U1)
+                              x
+                            ~R# Rep Direction x;
+        DirDown ->
+          lvl24
+          `cast` <Co:56> :: (:+:)
+                              (M1 C (MetaCons "DirUp" PrefixI False) U1
+                               :+: M1 C (MetaCons "DirDown" PrefixI False) U1)
+                              (M1 C (MetaCons "DirLeft" PrefixI False) U1
+                               :+: M1 C (MetaCons "DirRight" PrefixI False) U1)
+                              x
+                            ~R# Rep Direction x;
+        DirLeft ->
+          lvl26
+          `cast` <Co:56> :: (:+:)
+                              (M1 C (MetaCons "DirUp" PrefixI False) U1
+                               :+: M1 C (MetaCons "DirDown" PrefixI False) U1)
+                              (M1 C (MetaCons "DirLeft" PrefixI False) U1
+                               :+: M1 C (MetaCons "DirRight" PrefixI False) U1)
+                              x
+                            ~R# Rep Direction x;
+        DirRight ->
+          lvl28
+          `cast` <Co:56> :: (:+:)
+                              (M1 C (MetaCons "DirUp" PrefixI False) U1
+                               :+: M1 C (MetaCons "DirDown" PrefixI False) U1)
+                              (M1 C (MetaCons "DirLeft" PrefixI False) U1
+                               :+: M1 C (MetaCons "DirRight" PrefixI False) U1)
+                              x
+                            ~R# Rep Direction x
       }
-      }
-      }
-      }
-      }
 
 -- RHS size: {terms: 3, types: 1, coercions: 0, joins: 0/0}
-$fEqDirection = C:Eq $fEqDirection_$c== $fEqDirection_$c/=
+$fGenericDirection
+  = C:Generic $fGenericDirection_$cfrom $fGenericDirection_$cto
+
+-- RHS size: {terms: 3, types: 1, coercions: 0, joins: 0/0}
+$fBoundedDirection = C:Bounded DirUp DirRight
 
+-- RHS size: {terms: 10, types: 5, coercions: 0, joins: 0/0}
+$fEnumDirection_$cfromEnum
+  = \ a ->
+      case a of a1 { __DEFAULT ->
+      case dataToTagSmall# a1 of a# { __DEFAULT -> I# a# }
+      }
+
 -- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
 $fShowDirection4 = "DirUp"#
 
@@ -1372,7 +1524,397 @@
       $fShowDirection_$cshowsPrec
       $fShowDirection_$cshow
       $fShowDirection_$cshowList
+
+-- RHS size: {terms: 20, types: 11, coercions: 0, joins: 0/0}
+$fOrdDirection_$c<
+  = \ a b ->
+      case a of a1 { __DEFAULT ->
+      case b of b1 { __DEFAULT ->
+      case dataToTagSmall# a1 of a# { __DEFAULT ->
+      case dataToTagSmall# b1 of b# { __DEFAULT ->
+      tagToEnum# (<# a# b#)
+      }
+      }
+      }
+      }
+
+-- RHS size: {terms: 31, types: 12, coercions: 0, joins: 0/0}
+$fOrdDirection_$ccompare
+  = \ a b ->
+      case a of a1 { __DEFAULT ->
+      case b of b1 { __DEFAULT ->
+      case dataToTagSmall# a1 of a# { __DEFAULT ->
+      case dataToTagSmall# b1 of b# { __DEFAULT ->
+      case <# a# b# of {
+        __DEFAULT ->
+          case ==# a# b# of {
+            __DEFAULT -> GT;
+            1# -> EQ
+          };
+        1# -> LT
+      }
+      }
+      }
+      }
+      }
+
+-- RHS size: {terms: 24, types: 11, coercions: 0, joins: 0/0}
+$fOrdDirection_$c<=
+  = \ a b ->
+      case a of a1 { __DEFAULT ->
+      case b of b1 { __DEFAULT ->
+      case dataToTagSmall# b1 of a# { __DEFAULT ->
+      case dataToTagSmall# a1 of b# { __DEFAULT ->
+      case <# a# b# of {
+        __DEFAULT -> True;
+        1# -> False
+      }
+      }
+      }
+      }
+      }
+
+-- RHS size: {terms: 24, types: 11, coercions: 0, joins: 0/0}
+$fOrdDirection_$c>=
+  = \ a b ->
+      case a of a1 { __DEFAULT ->
+      case b of b1 { __DEFAULT ->
+      case dataToTagSmall# a1 of a# { __DEFAULT ->
+      case dataToTagSmall# b1 of b# { __DEFAULT ->
+      case <# a# b# of {
+        __DEFAULT -> True;
+        1# -> False
+      }
+      }
+      }
+      }
+      }
+
+-- RHS size: {terms: 24, types: 11, coercions: 0, joins: 0/0}
+$fOrdDirection_$cmax
+  = \ x y ->
+      case x of a { __DEFAULT ->
+      case y of b { __DEFAULT ->
+      case dataToTagSmall# b of a# { __DEFAULT ->
+      case dataToTagSmall# a of b# { __DEFAULT ->
+      case <# a# b# of {
+        __DEFAULT -> b;
+        1# -> a
+      }
+      }
+      }
+      }
+      }
+
+-- RHS size: {terms: 20, types: 11, coercions: 0, joins: 0/0}
+$fOrdDirection_$c>
+  = \ a b ->
+      case a of a1 { __DEFAULT ->
+      case b of b1 { __DEFAULT ->
+      case dataToTagSmall# b1 of a# { __DEFAULT ->
+      case dataToTagSmall# a1 of b# { __DEFAULT ->
+      tagToEnum# (<# a# b#)
+      }
+      }
+      }
+      }
+
+-- RHS size: {terms: 24, types: 11, coercions: 0, joins: 0/0}
+$fOrdDirection_$cmin
+  = \ x y ->
+      case x of a { __DEFAULT ->
+      case y of b { __DEFAULT ->
+      case dataToTagSmall# b of a# { __DEFAULT ->
+      case dataToTagSmall# a of b# { __DEFAULT ->
+      case <# a# b# of {
+        __DEFAULT -> a;
+        1# -> b
+      }
+      }
+      }
+      }
+      }
+
+-- RHS size: {terms: 9, types: 1, coercions: 0, joins: 0/0}
+$fOrdDirection
+  = C:Ord
+      $fEqDirection
+      $fOrdDirection_$ccompare
+      $fOrdDirection_$c<
+      $fOrdDirection_$c<=
+      $fOrdDirection_$c>
+      $fOrdDirection_$c>=
+      $fOrdDirection_$cmax
+      $fOrdDirection_$cmin
+
+-- RHS size: {terms: 295, types: 86, coercions: 0, joins: 0/28}
+$w$chash
+  = \ eta ->
+      case eta of {
+        DirUp ->
+          case timesWord2# 14695981039346656037## 0## of { (# hi1, lo1 #) ->
+          let {
+            x#
+              = plusWord#
+                  14695981039346656037##
+                  (plusWord# (xor# hi1 lo1) (byteSwap# 0##)) } in
+          let {
+            x#1
+              = timesWord#
+                  (xor# x# (uncheckedShiftRL# x# 33#)) 18397679294719823053## } in
+          let {
+            x#2
+              = timesWord#
+                  (xor# x#1 (uncheckedShiftRL# x#1 33#)) 14181476777654086739## } in
+          let { wild = xor# x#2 (uncheckedShiftRL# x#2 33#) } in
+          case timesWord2# wild 0## of { (# hi2, lo2 #) ->
+          let {
+            x#4
+              = plusWord# (plusWord# (byteSwap# 0##) wild) (xor# hi2 lo2) } in
+          let {
+            x#5
+              = timesWord#
+                  (xor# x#4 (uncheckedShiftRL# x#4 33#)) 18397679294719823053## } in
+          let {
+            x#6
+              = timesWord#
+                  (xor# x#5 (uncheckedShiftRL# x#5 33#)) 14181476777654086739## } in
+          word2Int# (xor# x#6 (uncheckedShiftRL# x#6 33#))
+          }
+          };
+        DirDown ->
+          case timesWord2# 14695981039346656037## 1## of { (# hi1, lo1 #) ->
+          let {
+            x#
+              = plusWord#
+                  14695981039346656037##
+                  (plusWord# (xor# hi1 lo1) (byteSwap# 1##)) } in
+          let {
+            x#1
+              = timesWord#
+                  (xor# x# (uncheckedShiftRL# x# 33#)) 18397679294719823053## } in
+          let {
+            x#2
+              = timesWord#
+                  (xor# x#1 (uncheckedShiftRL# x#1 33#)) 14181476777654086739## } in
+          let { wild = xor# x#2 (uncheckedShiftRL# x#2 33#) } in
+          case timesWord2# wild 0## of { (# hi2, lo2 #) ->
+          let {
+            x#4
+              = plusWord# (plusWord# (byteSwap# 0##) wild) (xor# hi2 lo2) } in
+          let {
+            x#5
+              = timesWord#
+                  (xor# x#4 (uncheckedShiftRL# x#4 33#)) 18397679294719823053## } in
+          let {
+            x#6
+              = timesWord#
+                  (xor# x#5 (uncheckedShiftRL# x#5 33#)) 14181476777654086739## } in
+          word2Int# (xor# x#6 (uncheckedShiftRL# x#6 33#))
+          }
+          };
+        DirLeft ->
+          case timesWord2# 14695981039346656037## 2## of { (# hi1, lo1 #) ->
+          let {
+            x#
+              = plusWord#
+                  14695981039346656037##
+                  (plusWord# (xor# hi1 lo1) (byteSwap# 2##)) } in
+          let {
+            x#1
+              = timesWord#
+                  (xor# x# (uncheckedShiftRL# x# 33#)) 18397679294719823053## } in
+          let {
+            x#2
+              = timesWord#
+                  (xor# x#1 (uncheckedShiftRL# x#1 33#)) 14181476777654086739## } in
+          let { wild = xor# x#2 (uncheckedShiftRL# x#2 33#) } in
+          case timesWord2# wild 0## of { (# hi2, lo2 #) ->
+          let {
+            x#4
+              = plusWord# (plusWord# (byteSwap# 0##) wild) (xor# hi2 lo2) } in
+          let {
+            x#5
+              = timesWord#
+                  (xor# x#4 (uncheckedShiftRL# x#4 33#)) 18397679294719823053## } in
+          let {
+            x#6
+              = timesWord#
+                  (xor# x#5 (uncheckedShiftRL# x#5 33#)) 14181476777654086739## } in
+          word2Int# (xor# x#6 (uncheckedShiftRL# x#6 33#))
+          }
+          };
+        DirRight ->
+          case timesWord2# 14695981039346656037## 3## of { (# hi1, lo1 #) ->
+          let {
+            x#
+              = plusWord#
+                  14695981039346656037##
+                  (plusWord# (xor# hi1 lo1) (byteSwap# 3##)) } in
+          let {
+            x#1
+              = timesWord#
+                  (xor# x# (uncheckedShiftRL# x# 33#)) 18397679294719823053## } in
+          let {
+            x#2
+              = timesWord#
+                  (xor# x#1 (uncheckedShiftRL# x#1 33#)) 14181476777654086739## } in
+          let { wild = xor# x#2 (uncheckedShiftRL# x#2 33#) } in
+          case timesWord2# wild 0## of { (# hi2, lo2 #) ->
+          let {
+            x#4
+              = plusWord# (plusWord# (byteSwap# 0##) wild) (xor# hi2 lo2) } in
+          let {
+            x#5
+              = timesWord#
+                  (xor# x#4 (uncheckedShiftRL# x#4 33#)) 18397679294719823053## } in
+          let {
+            x#6
+              = timesWord#
+                  (xor# x#5 (uncheckedShiftRL# x#5 33#)) 14181476777654086739## } in
+          word2Int# (xor# x#6 (uncheckedShiftRL# x#6 33#))
+          }
+          }
+      }
 
+-- RHS size: {terms: 7, types: 2, coercions: 0, joins: 0/0}
+$fHashableDirection_$chash
+  = \ eta -> case $w$chash eta of ww { __DEFAULT -> I# ww }
+
+-- RHS size: {terms: 308, types: 91, coercions: 0, joins: 0/32}
+$w$fHashableDirection
+  = \ ww eta ->
+      case eta of {
+        DirUp ->
+          let { y# = int2Word# ww } in
+          case timesWord2# y# 0## of { (# hi1, lo1 #) ->
+          let {
+            x# = plusWord# (plusWord# (byteSwap# 0##) y#) (xor# hi1 lo1) } in
+          let {
+            x#1
+              = timesWord#
+                  (xor# x# (uncheckedShiftRL# x# 33#)) 18397679294719823053## } in
+          let {
+            x#2
+              = timesWord#
+                  (xor# x#1 (uncheckedShiftRL# x#1 33#)) 14181476777654086739## } in
+          let { wild = xor# x#2 (uncheckedShiftRL# x#2 33#) } in
+          case timesWord2# wild 0## of { (# hi2, lo2 #) ->
+          let {
+            x#4
+              = plusWord# (plusWord# (byteSwap# 0##) wild) (xor# hi2 lo2) } in
+          let {
+            x#5
+              = timesWord#
+                  (xor# x#4 (uncheckedShiftRL# x#4 33#)) 18397679294719823053## } in
+          let {
+            x#6
+              = timesWord#
+                  (xor# x#5 (uncheckedShiftRL# x#5 33#)) 14181476777654086739## } in
+          word2Int# (xor# x#6 (uncheckedShiftRL# x#6 33#))
+          }
+          };
+        DirDown ->
+          let { y# = int2Word# ww } in
+          case timesWord2# y# 1## of { (# hi1, lo1 #) ->
+          let {
+            x# = plusWord# (plusWord# (byteSwap# 1##) y#) (xor# hi1 lo1) } in
+          let {
+            x#1
+              = timesWord#
+                  (xor# x# (uncheckedShiftRL# x# 33#)) 18397679294719823053## } in
+          let {
+            x#2
+              = timesWord#
+                  (xor# x#1 (uncheckedShiftRL# x#1 33#)) 14181476777654086739## } in
+          let { wild = xor# x#2 (uncheckedShiftRL# x#2 33#) } in
+          case timesWord2# wild 0## of { (# hi2, lo2 #) ->
+          let {
+            x#4
+              = plusWord# (plusWord# (byteSwap# 0##) wild) (xor# hi2 lo2) } in
+          let {
+            x#5
+              = timesWord#
+                  (xor# x#4 (uncheckedShiftRL# x#4 33#)) 18397679294719823053## } in
+          let {
+            x#6
+              = timesWord#
+                  (xor# x#5 (uncheckedShiftRL# x#5 33#)) 14181476777654086739## } in
+          word2Int# (xor# x#6 (uncheckedShiftRL# x#6 33#))
+          }
+          };
+        DirLeft ->
+          let { y# = int2Word# ww } in
+          case timesWord2# y# 2## of { (# hi1, lo1 #) ->
+          let {
+            x# = plusWord# (plusWord# (byteSwap# 2##) y#) (xor# hi1 lo1) } in
+          let {
+            x#1
+              = timesWord#
+                  (xor# x# (uncheckedShiftRL# x# 33#)) 18397679294719823053## } in
+          let {
+            x#2
+              = timesWord#
+                  (xor# x#1 (uncheckedShiftRL# x#1 33#)) 14181476777654086739## } in
+          let { wild = xor# x#2 (uncheckedShiftRL# x#2 33#) } in
+          case timesWord2# wild 0## of { (# hi2, lo2 #) ->
+          let {
+            x#4
+              = plusWord# (plusWord# (byteSwap# 0##) wild) (xor# hi2 lo2) } in
+          let {
+            x#5
+              = timesWord#
+                  (xor# x#4 (uncheckedShiftRL# x#4 33#)) 18397679294719823053## } in
+          let {
+            x#6
+              = timesWord#
+                  (xor# x#5 (uncheckedShiftRL# x#5 33#)) 14181476777654086739## } in
+          word2Int# (xor# x#6 (uncheckedShiftRL# x#6 33#))
+          }
+          };
+        DirRight ->
+          let { y# = int2Word# ww } in
+          case timesWord2# y# 3## of { (# hi1, lo1 #) ->
+          let {
+            x# = plusWord# (plusWord# (byteSwap# 3##) y#) (xor# hi1 lo1) } in
+          let {
+            x#1
+              = timesWord#
+                  (xor# x# (uncheckedShiftRL# x# 33#)) 18397679294719823053## } in
+          let {
+            x#2
+              = timesWord#
+                  (xor# x#1 (uncheckedShiftRL# x#1 33#)) 14181476777654086739## } in
+          let { wild = xor# x#2 (uncheckedShiftRL# x#2 33#) } in
+          case timesWord2# wild 0## of { (# hi2, lo2 #) ->
+          let {
+            x#4
+              = plusWord# (plusWord# (byteSwap# 0##) wild) (xor# hi2 lo2) } in
+          let {
+            x#5
+              = timesWord#
+                  (xor# x#4 (uncheckedShiftRL# x#4 33#)) 18397679294719823053## } in
+          let {
+            x#6
+              = timesWord#
+                  (xor# x#5 (uncheckedShiftRL# x#5 33#)) 14181476777654086739## } in
+          word2Int# (xor# x#6 (uncheckedShiftRL# x#6 33#))
+          }
+          }
+      }
+
+-- RHS size: {terms: 12, types: 5, coercions: 0, joins: 0/0}
+$fHashableDirection1
+  = \ eta eta1 ->
+      case eta of { I# ww ->
+      case $w$fHashableDirection ww eta1 of ww1 { __DEFAULT -> I# ww1 }
+      }
+
+-- RHS size: {terms: 4, types: 1, coercions: 0, joins: 0/0}
+$fHashableDirection
+  = C:Hashable
+      $fEqDirection $fHashableDirection1 $fHashableDirection_$chash
+
 -- RHS size: {terms: 6, types: 9, coercions: 0, joins: 0/0}
 _game'width
   = \ ds -> case ds of { Game ds1 ds2 bx bx1 bx2 -> I# bx2 }
@@ -1452,13 +1994,13 @@
 moveGame8 = I# 0#
 
 -- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
-lvl21 = "Int"#
+lvl29 = "Int"#
 
 -- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
-lvl22 = unpackCString# lvl21
+lvl30 = unpackCString# lvl29
 
 -- RHS size: {terms: 7, types: 3, coercions: 0, joins: 0/0}
-moveGame7 = \ ww ww1 -> $w$sindexError ww ww1 0# lvl22
+moveGame7 = \ ww ww1 -> $w$sindexError ww ww1 0# lvl30
 
 -- RHS size: {terms: 53, types: 17, coercions: 0, joins: 0/1}
 $w$sreadIR
@@ -1508,7 +2050,7 @@
       case ds `cast` <Co:2> :: IntRef s ~R# STUArray s Int Int of x
       { STUArray ipv ipv1 ipv2 ipv3 ->
       let { $dMonad = $p1MArray $dMArray } in
-      let { lvl34 = getNumElements $dMArray $fIxInt x } in
+      let { lvl50 = getNumElements $dMArray $fIxInt x } in
       >>=
         $dMonad
         (getBounds $dMArray $fIxInt x)
@@ -1528,10 +2070,10 @@
                  }
                  }
                  } } in
-           let { lvl35 = case i' of { I# y -> tagToEnum# (<=# 0# y) } } in
+           let { lvl51 = case i' of { I# y -> tagToEnum# (<=# 0# y) } } in
            >>=
              $dMonad
-             lvl34
+             lvl50
              (\ n ->
                 unsafeWrite
                   $dMArray
@@ -1549,7 +2091,7 @@
                                  (unpackAppendCString#
                                     lvl14 (case n of { I# n3 -> ++ (itos n3 []) lvl16 }))
                                })) } in
-                   case lvl35 of {
+                   case lvl51 of {
                      False -> jump $j;
                      True ->
                        case i' of wild2 { I# x1 ->
@@ -1565,6 +2107,29 @@
            })
       }
 
+Rec {
+-- RHS size: {terms: 13, types: 5, coercions: 0, joins: 0/0}
+$fEnumDirection_go3
+  = \ x ->
+      : (tagToEnum# x)
+        (case x of wild {
+           __DEFAULT -> $fEnumDirection_go3 (+# wild 1#);
+           3# -> []
+         })
+end Rec }
+
+-- RHS size: {terms: 17, types: 7, coercions: 0, joins: 0/0}
+$fEnumDirection_$cenumFrom
+  = \ a ->
+      case a of a1 { __DEFAULT ->
+      case dataToTagSmall# a1 of a# { __DEFAULT ->
+      case ># a# 3# of {
+        __DEFAULT -> $fEnumDirection_go3 a#;
+        1# -> []
+      }
+      }
+      }
+
 -- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
 $trModule4 = "gemssearch002-0.1.1.0-7JCS4lC1W6kLF6hjL0vDnM"#
 
@@ -1972,6 +2537,166 @@
       $tc'DirRight1
       0#
       $tc'DirDown1
+
+-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
+loc = unpackCString# $trModule4
+
+-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
+loc1 = unpackCString# $trModule2
+
+-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
+loc2 = "src/TotM2.hs"#
+
+-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
+loc3 = unpackCString# loc2
+
+-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
+loc4 = I# 214#
+
+-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
+loc5 = I# 27#
+
+-- RHS size: {terms: 8, types: 0, coercions: 0, joins: 0/0}
+$dIP = SrcLoc loc loc1 loc3 loc4 loc5 loc4 lvl9
+
+-- RHS size: {terms: 4, types: 0, coercions: 0, joins: 0/0}
+$dIP1 = PushCallStack lvl1 $dIP EmptyCallStack
+
+-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
+lvl31 = ") is outside of enumeration's range (0,"#
+
+-- RHS size: {terms: 4, types: 0, coercions: 0, joins: 0/0}
+lvl32 = $wshowSignedInt 0# 3# lvl16
+
+-- RHS size: {terms: 3, types: 0, coercions: 0, joins: 0/0}
+lvl33 = unpackAppendCString# lvl31 lvl32
+
+-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
+lvl34 = "toEnum{Direction}: tag ("#
+
+-- RHS size: {terms: 9, types: 3, coercions: 4, joins: 0/0}
+$wlvl
+  = \ ww ->
+      error
+        ($dIP1 `cast` <Co:4> :: CallStack ~R# (?callStack::CallStack))
+        (unpackAppendCString# lvl34 ($wshowSignedInt 0# ww lvl33))
+
+-- RHS size: {terms: 6, types: 3, coercions: 0, joins: 0/0}
+$fEnumDirection1 = \ a -> case a of { I# ww -> $wlvl ww }
+
+-- RHS size: {terms: 22, types: 6, coercions: 0, joins: 0/0}
+$fEnumDirection_$ctoEnum
+  = \ a ->
+      case a of { I# ipv ->
+      case >=# ipv 0# of {
+        __DEFAULT -> $wlvl ipv;
+        1# ->
+          case <=# ipv 3# of {
+            __DEFAULT -> $wlvl ipv;
+            1# -> tagToEnum# ipv
+          }
+      }
+      }
+
+-- RHS size: {terms: 230, types: 93, coercions: 0, joins: 0/12}
+$fEnumDirection_$cenumFromThen
+  = \ a b ->
+      case a of a1 { __DEFAULT ->
+      case b of b1 { __DEFAULT ->
+      case dataToTagSmall# a1 of a# { __DEFAULT ->
+      case dataToTagSmall# b1 of b# { __DEFAULT ->
+      case ># a# b# of {
+        __DEFAULT ->
+          case >=# b# a# of {
+            __DEFAULT ->
+              case ># 3# b# of {
+                __DEFAULT ->
+                  : (tagToEnum# a#)
+                    (let { delta = -# b# a# } in
+                     let { y' = -# 3# delta } in
+                     letrec {
+                       go_dn
+                         = \ x ->
+                             case <# x y' of {
+                               __DEFAULT -> : (tagToEnum# x) (go_dn (+# x delta));
+                               1# -> : (tagToEnum# x) []
+                             }; } in
+                     go_dn b#);
+                1# ->
+                  case ># 3# a# of {
+                    __DEFAULT -> : (tagToEnum# a#) [];
+                    1# -> []
+                  }
+              };
+            1# ->
+              case <# 3# b# of {
+                __DEFAULT ->
+                  : (tagToEnum# a#)
+                    (let { delta = -# b# a# } in
+                     let { y' = -# 3# delta } in
+                     letrec {
+                       go_up
+                         = \ x ->
+                             case ># x y' of {
+                               __DEFAULT -> : (tagToEnum# x) (go_up (+# x delta));
+                               1# -> : (tagToEnum# x) []
+                             }; } in
+                     go_up b#);
+                1# ->
+                  case <# 3# a# of {
+                    __DEFAULT -> : (tagToEnum# a#) [];
+                    1# -> []
+                  }
+              }
+          };
+        1# ->
+          case >=# b# a# of {
+            __DEFAULT ->
+              case ># 0# b# of {
+                __DEFAULT ->
+                  : (tagToEnum# a#)
+                    (let { delta = -# b# a# } in
+                     let { y' = -# 0# delta } in
+                     letrec {
+                       go_dn
+                         = \ x ->
+                             case <# x y' of {
+                               __DEFAULT -> : (tagToEnum# x) (go_dn (+# x delta));
+                               1# -> : (tagToEnum# x) []
+                             }; } in
+                     go_dn b#);
+                1# ->
+                  case ># 0# a# of {
+                    __DEFAULT -> : (tagToEnum# a#) [];
+                    1# -> []
+                  }
+              };
+            1# ->
+              case <# 0# b# of {
+                __DEFAULT ->
+                  : (tagToEnum# a#)
+                    (let { delta = -# b# a# } in
+                     let { y' = -# 0# delta } in
+                     letrec {
+                       go_up
+                         = \ x ->
+                             case ># x y' of {
+                               __DEFAULT -> : (tagToEnum# x) (go_up (+# x delta));
+                               1# -> : (tagToEnum# x) []
+                             }; } in
+                     go_up b#);
+                1# ->
+                  case <# 0# a# of {
+                    __DEFAULT -> : (tagToEnum# a#) [];
+                    1# -> []
+                  }
+              }
+          }
+      }
+      }
+      }
+      }
+      }
 
 -- RHS size: {terms: 120, types: 81, coercions: 2, joins: 0/0}
 $w$ccompare1
@@ -2138,6 +2863,224 @@
 -- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
 $bAir = W8# 0#Word8
 
+-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
+lvl35
+  = "succ{Direction}: tried to take `succ' of last tag in enumeration"#
+
+-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
+lvl36 = unpackCString# lvl35
+
+-- RHS size: {terms: 3, types: 2, coercions: 4, joins: 0/0}
+$fEnumDirection3
+  = error
+      ($dIP1 `cast` <Co:4> :: CallStack ~R# (?callStack::CallStack))
+      lvl36
+
+-- RHS size: {terms: 14, types: 6, coercions: 0, joins: 0/0}
+$fEnumDirection_$csucc
+  = \ a ->
+      case a of a1 {
+        __DEFAULT ->
+          case dataToTagSmall# a1 of a# { __DEFAULT ->
+          tagToEnum# (+# a# 1#)
+          };
+        DirRight -> $fEnumDirection3
+      }
+
+-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
+lvl37
+  = "pred{Direction}: tried to take `pred' of first tag in enumeration"#
+
+-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
+lvl38 = unpackCString# lvl37
+
+-- RHS size: {terms: 3, types: 2, coercions: 4, joins: 0/0}
+$fEnumDirection2
+  = error
+      ($dIP1 `cast` <Co:4> :: CallStack ~R# (?callStack::CallStack))
+      lvl38
+
+-- RHS size: {terms: 14, types: 6, coercions: 0, joins: 0/0}
+$fEnumDirection_$cpred
+  = \ a ->
+      case a of a1 {
+        __DEFAULT ->
+          case dataToTagSmall# a1 of a# { __DEFAULT ->
+          tagToEnum# (+# a# -1#)
+          };
+        DirUp -> $fEnumDirection2
+      }
+
+-- RHS size: {terms: 256, types: 72, coercions: 0, joins: 0/6}
+$fEnumDirection_$cenumFromThenTo
+  = \ x1 x2 y ->
+      case x1 of a { __DEFAULT ->
+      case dataToTagSmall# a of a# { __DEFAULT ->
+      case x2 of a1 { __DEFAULT ->
+      case dataToTagSmall# a1 of a#1 { __DEFAULT ->
+      case y of a2 { __DEFAULT ->
+      case dataToTagSmall# a2 of a#2 { __DEFAULT ->
+      case >=# a#1 a# of {
+        __DEFAULT ->
+          case ># a#2 a#1 of {
+            __DEFAULT ->
+              : (case >=# a# 0# of {
+                   __DEFAULT -> $wlvl a#;
+                   1# ->
+                     case <=# a# 3# of {
+                       __DEFAULT -> $wlvl a#;
+                       1# -> tagToEnum# a#
+                     }
+                 })
+                (let { delta = -# a#1 a# } in
+                 let { y' = -# a#2 delta } in
+                 letrec {
+                   go_dn
+                     = \ x ->
+                         case <# x y' of {
+                           __DEFAULT ->
+                             : (case >=# x 0# of {
+                                  __DEFAULT -> $wlvl x;
+                                  1# ->
+                                    case <=# x 3# of {
+                                      __DEFAULT -> $wlvl x;
+                                      1# -> tagToEnum# x
+                                    }
+                                })
+                               (go_dn (+# x delta));
+                           1# ->
+                             : (case >=# x 0# of {
+                                  __DEFAULT -> $wlvl x;
+                                  1# ->
+                                    case <=# x 3# of {
+                                      __DEFAULT -> $wlvl x;
+                                      1# -> tagToEnum# x
+                                    }
+                                })
+                               []
+                         }; } in
+                 go_dn a#1);
+            1# ->
+              case ># a#2 a# of {
+                __DEFAULT ->
+                  : (case >=# a# 0# of {
+                       __DEFAULT -> $wlvl a#;
+                       1# ->
+                         case <=# a# 3# of {
+                           __DEFAULT -> $wlvl a#;
+                           1# -> tagToEnum# a#
+                         }
+                     })
+                    [];
+                1# -> []
+              }
+          };
+        1# ->
+          case <# a#2 a#1 of {
+            __DEFAULT ->
+              : (case >=# a# 0# of {
+                   __DEFAULT -> $wlvl a#;
+                   1# ->
+                     case <=# a# 3# of {
+                       __DEFAULT -> $wlvl a#;
+                       1# -> tagToEnum# a#
+                     }
+                 })
+                (let { delta = -# a#1 a# } in
+                 let { y' = -# a#2 delta } in
+                 letrec {
+                   go_up
+                     = \ x ->
+                         case ># x y' of {
+                           __DEFAULT ->
+                             : (case >=# x 0# of {
+                                  __DEFAULT -> $wlvl x;
+                                  1# ->
+                                    case <=# x 3# of {
+                                      __DEFAULT -> $wlvl x;
+                                      1# -> tagToEnum# x
+                                    }
+                                })
+                               (go_up (+# x delta));
+                           1# ->
+                             : (case >=# x 0# of {
+                                  __DEFAULT -> $wlvl x;
+                                  1# ->
+                                    case <=# x 3# of {
+                                      __DEFAULT -> $wlvl x;
+                                      1# -> tagToEnum# x
+                                    }
+                                })
+                               []
+                         }; } in
+                 go_up a#1);
+            1# ->
+              case <# a#2 a# of {
+                __DEFAULT ->
+                  : (case >=# a# 0# of {
+                       __DEFAULT -> $wlvl a#;
+                       1# ->
+                         case <=# a# 3# of {
+                           __DEFAULT -> $wlvl a#;
+                           1# -> tagToEnum# a#
+                         }
+                     })
+                    [];
+                1# -> []
+              }
+          }
+      }
+      }
+      }
+      }
+      }
+      }
+      }
+
+-- RHS size: {terms: 57, types: 22, coercions: 0, joins: 0/1}
+$fEnumDirection_$cenumFromTo
+  = \ x y ->
+      case x of a { __DEFAULT ->
+      case dataToTagSmall# a of a# { __DEFAULT ->
+      case y of a1 { __DEFAULT ->
+      case dataToTagSmall# a1 of a#1 { __DEFAULT ->
+      case ># a# a#1 of {
+        __DEFAULT ->
+          letrec {
+            go3
+              = \ x1 ->
+                  : (case >=# x1 0# of {
+                       __DEFAULT -> $wlvl x1;
+                       1# ->
+                         case <=# x1 3# of {
+                           __DEFAULT -> $wlvl x1;
+                           1# -> tagToEnum# x1
+                         }
+                     })
+                    (case ==# x1 a#1 of {
+                       __DEFAULT -> go3 (+# x1 1#);
+                       1# -> []
+                     }); } in
+          go3 a#;
+        1# -> []
+      }
+      }
+      }
+      }
+      }
+
+-- RHS size: {terms: 9, types: 1, coercions: 0, joins: 0/0}
+$fEnumDirection
+  = C:Enum
+      $fEnumDirection_$csucc
+      $fEnumDirection_$cpred
+      $fEnumDirection_$ctoEnum
+      $fEnumDirection_$cfromEnum
+      $fEnumDirection_$cenumFrom
+      $fEnumDirection_$cenumFromThen
+      $fEnumDirection_$cenumFromTo
+      $fEnumDirection_$cenumFromThenTo
+
 -- RHS size: {terms: 24, types: 19, coercions: 0, joins: 0/0}
 $fOrdGame_$c<=
   = \ a b ->
@@ -2208,7 +3151,7 @@
       $fOrdGame_$cmin
 
 -- RHS size: {terms: 257, types: 87, coercions: 0, joins: 0/30}
-$w$chash
+$w$chash1
   = \ ww ww1 ww2 ww3 ww4 ww5 ->
       let { len = sizeofByteArray# ww } in
       let { w = int2Word# len } in
@@ -2335,7 +3278,7 @@
       case ww1 of { (ww9, ww10) ->
       case ww9 of { I# ww11 ->
       case ww10 of { I# ww12 ->
-      case $w$chash ww8 ww11 ww12 ww2 ww3 ww4 of ww13 { __DEFAULT ->
+      case $w$chash1 ww8 ww11 ww12 ww2 ww3 ww4 of ww13 { __DEFAULT ->
       I# ww13
       }
       }
@@ -2487,40 +3430,40 @@
   = C:Hashable $fEqGame $fHashableGame1 $fHashableGame_$chash
 
 -- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
-lvl23 = I# 98#
+lvl39 = I# 98#
 
 -- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
-lvl24 = I# 40#
+lvl40 = I# 40#
 
 -- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
-lvl25 = I# 45#
+lvl41 = I# 45#
 
 -- RHS size: {terms: 8, types: 0, coercions: 0, joins: 0/0}
-lvl26 = SrcLoc lvl3 lvl5 lvl7 lvl23 lvl24 lvl23 lvl25
+lvl42 = SrcLoc lvl3 lvl5 lvl7 lvl39 lvl40 lvl39 lvl41
 
 -- RHS size: {terms: 4, types: 0, coercions: 0, joins: 0/0}
-lvl27 = PushCallStack lvl1 lvl26 EmptyCallStack
+lvl43 = PushCallStack lvl1 lvl42 EmptyCallStack
 
 -- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
-lvl28 = "Negative range size"#
+lvl44 = "Negative range size"#
 
 -- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
-lvl29 = unpackCString# lvl28
+lvl45 = unpackCString# lvl44
 
 -- RHS size: {terms: 3, types: 2, coercions: 4, joins: 0/0}
-lvl30
+lvl46
   = error
-      (lvl27 `cast` <Co:4> :: CallStack ~R# (?callStack::CallStack))
-      lvl29
+      (lvl43 `cast` <Co:4> :: CallStack ~R# (?callStack::CallStack))
+      lvl45
 
 -- RHS size: {terms: 15, types: 7, coercions: 4, joins: 0/0}
-lvl31
-  = \ y lvl34 ->
+lvl47
+  = \ y lvl50 ->
       error
         (lvl12 `cast` <Co:4> :: CallStack ~R# (?callStack::CallStack))
         (unpackAppendCString#
            lvl13
-           (++ (itos y []) (unpackAppendCString# lvl14 (++ lvl34 lvl16))))
+           (++ (itos y []) (unpackAppendCString# lvl14 (++ lvl50 lvl16))))
 
 -- RHS size: {terms: 445, types: 346, coercions: 0, joins: 12/21}
 $wteardownGameBoard
@@ -2539,8 +3482,8 @@
                            let { y = -# x 1# } in
                            join {
                              $w$j ipv2
-                               = join { exit y1 = case lvl31 y1 (itos ww8 []) of {} } in
-                                 join { exit1 y1 = case lvl31 y1 (itos ww4 []) of {} } in
+                               = join { exit y1 = case lvl47 y1 (itos ww8 []) of {} } in
+                                 join { exit1 y1 = case lvl47 y1 (itos ww4 []) of {} } in
                                  join {
                                    $w$j1 ipv4
                                      = case unsafeFreezeByteArray# ipv1 ipv4 of { (# s2#, arr# #) ->
@@ -2794,7 +3737,7 @@
                                jump go3 0# ipv;
                              1# -> jump $w$j ipv
                            };
-                         1# -> case lvl30 of {}
+                         1# -> case lvl46 of {}
                        } } in
                  case <=# 0# u of {
                    __DEFAULT -> jump $j1 0#;
@@ -2882,7 +3825,7 @@
           }
       }
 
--- RHS size: {terms: 115, types: 45, coercions: 0, joins: 0/3}
+-- RHS size: {terms: 114, types: 45, coercions: 0, joins: 0/3}
 $wreadSA
   = \ @s ww ww1 ww2 ww3 ww4 ww5 ww6 ww7 eta ->
       case <=# ww ww6 of {
@@ -2906,20 +3849,19 @@
                             __DEFAULT -> case moveGame6 y ww4 of {};
                             1# ->
                               case readWordArray# ww5 y eta of { (# ipv, ipv1 #) ->
-                              (# ipv,
-                                 let { i# = *# 2# (andI# ww7 31#) } in
-                                 case >=# i# 0# of {
-                                   __DEFAULT -> case overflowError of {};
-                                   1# ->
-                                     W8#
-                                       (wordToWord8#
+                              let { i# = *# 2# (andI# ww7 31#) } in
+                              case >=# i# 0# of {
+                                __DEFAULT -> case overflowError of {};
+                                1# ->
+                                  (# ipv,
+                                     wordToWord8#
+                                       (and#
                                           (and#
-                                             (and#
-                                                (uncheckedShiftRL# ipv1 i#)
-                                                (int2Word# (negateInt# (<# i# 64#))))
-                                             3##))
-                                 } #)
+                                             (uncheckedShiftRL# ipv1 i#)
+                                             (int2Word# (negateInt# (<# i# 64#))))
+                                          3##) #)
                               }
+                              }
                           }
                       }
                   }
@@ -2928,14 +3870,14 @@
       }
 
 -- RHS size: {terms: 3, types: 7, coercions: 0, joins: 0/0}
-lvl32 = \ @s -> Left Lost
+lvl48 = \ @s -> Left Lost
 
 -- RHS size: {terms: 3, types: 5, coercions: 0, joins: 0/0}
-lvl33 = \ @s -> Right ()
+lvl49 = \ @s -> Right ()
 
 Rec {
--- RHS size: {terms: 1,095,
-              types: 1,080,
+-- RHS size: {terms: 1,068,
+              types: 1,062,
               coercions: 40,
               joins: 8/13}
 $wchain
@@ -2952,82 +3894,79 @@
       case l of { I# m ->
       case u of { I# n ->
       case next of next1 { __DEFAULT ->
-      let { lvl34 = Won wild } in
-      let { lvl35 = Left lvl34 } in
+      let { lvl50 = Won wild } in
+      let { lvl51 = Left lvl50 } in
       let { locationGood = -# bx 1# } in
       let { locationGood1 = -# bx1 1# } in
       let { y = -# 0# m } in
       case ww of wild8 { I# i ->
       case <=# 0# i of {
-        __DEFAULT -> (# eta, lvl33 #);
+        __DEFAULT -> (# eta, lvl49 #);
         1# ->
           case <=# i locationGood of {
-            __DEFAULT -> (# eta, lvl33 #);
+            __DEFAULT -> (# eta, lvl49 #);
             1# ->
               case ww1 of wild9 { I# i4 ->
               case <=# 0# i4 of {
-                __DEFAULT -> (# eta, lvl33 #);
+                __DEFAULT -> (# eta, lvl49 #);
                 1# ->
                   case <=# i4 locationGood1 of {
-                    __DEFAULT -> (# eta, lvl33 #);
+                    __DEFAULT -> (# eta, lvl49 #);
                     1# ->
                       case ww6 of { I# ww10 ->
                       case ww7 of { I# ww11 ->
                       case ww8 of { I# ww12 ->
                       case ww9 of { I# ww13 ->
                       case $wreadSA ww10 ww11 ww12 ww13 ww4 ww5 i i4 eta of
-                      { (# ipv, ipv1 #) ->
-                      case ipv1 of { W8# ipv2 ->
-                      case next1 (wild8, wild9) of { (ipv3, ipv4) ->
+                      { (# ww14, ww15 #) ->
+                      case next1 (wild8, wild9) of { (ipv, ipv1) ->
                       join {
                         $j
-                          = case ipv3 of wild14 { I# i1 ->
+                          = case ipv of wild15 { I# i1 ->
                             case <=# 0# i1 of {
-                              __DEFAULT -> (# ipv, lvl33 #);
+                              __DEFAULT -> (# ww14, lvl49 #);
                               1# ->
                                 case <=# i1 locationGood of {
-                                  __DEFAULT -> (# ipv, lvl33 #);
+                                  __DEFAULT -> (# ww14, lvl49 #);
                                   1# ->
-                                    case ipv4 of wild15 { I# i2 ->
+                                    case ipv1 of wild16 { I# i2 ->
                                     case <=# 0# i2 of {
-                                      __DEFAULT -> (# ipv, lvl33 #);
+                                      __DEFAULT -> (# ww14, lvl49 #);
                                       1# ->
                                         case <=# i2 locationGood1 of {
-                                          __DEFAULT -> (# ipv, lvl33 #);
+                                          __DEFAULT -> (# ww14, lvl49 #);
                                           1# ->
-                                            case $wreadSA ww10 ww11 ww12 ww13 ww4 ww5 i1 i2 ipv of
-                                            { (# ipv5, ipv6 #) ->
-                                            case ipv6 of { W8# ipv7 ->
-                                            case word8ToWord# ipv7 of {
+                                            case $wreadSA ww10 ww11 ww12 ww13 ww4 ww5 i1 i2 ww14 of
+                                            { (# ww16, ww17 #) ->
+                                            case word8ToWord# ww17 of {
                                               __DEFAULT ->
-                                                case $wchain wild next1 wild14 wild15 ipv5 of ds5
-                                                { (# ipv8, ipv9 #) ->
-                                                case ipv9 of {
-                                                  Left e1 -> ds5;
+                                                case $wchain wild next1 wild15 wild16 ww16 of ds1
+                                                { (# ipv2, ipv3 #) ->
+                                                case ipv3 of {
+                                                  Left e1 -> ds1;
                                                   Right x ->
                                                     case $wreadSA
-                                                           ww10 ww11 ww12 ww13 ww4 ww5 i1 i2 ipv8
+                                                           ww10 ww11 ww12 ww13 ww4 ww5 i1 i2 ipv2
                                                     of
-                                                    { (# ipv10, ipv11 #) ->
-                                                    case ipv11 of { W8# ipv12 ->
-                                                    case word8ToWord# ipv12 of {
+                                                    { (# ww18, ww19 #) ->
+                                                    case word8ToWord# ww19 of {
                                                       __DEFAULT ->
                                                         joinrec {
                                                           $s$wgo0 sc sc1 sc2
                                                             = case <=# 0# sc2 of {
-                                                                __DEFAULT -> (# sc, lvl33 #);
+                                                                __DEFAULT -> (# sc, lvl49 #);
                                                                 1# ->
                                                                   case <=# sc2 locationGood of {
-                                                                    __DEFAULT -> (# sc, lvl33 #);
+                                                                    __DEFAULT -> (# sc, lvl49 #);
                                                                     1# ->
                                                                       case <=# 0# sc1 of {
                                                                         __DEFAULT ->
-                                                                          (# sc, lvl33 #);
+                                                                          (# sc, lvl49 #);
                                                                         1# ->
                                                                           case <=# sc1 locationGood1
                                                                           of {
                                                                             __DEFAULT ->
-                                                                              (# sc, lvl33 #);
+                                                                              (# sc, lvl49 #);
                                                                             1# ->
                                                                               case $wreadSA
                                                                                      ww10
@@ -3040,52 +3979,49 @@
                                                                                      sc1
                                                                                      sc
                                                                               of
-                                                                              { (# ipv13,
-                                                                                   ipv14 #) ->
-                                                                              case ipv14 of
-                                                                              { W8# ipv15 ->
+                                                                              { (# ww20, ww21 #) ->
                                                                               case next1
                                                                                      (I# sc2,
                                                                                       I# sc1)
                                                                               of
-                                                                              { (ipv16, ipv17) ->
+                                                                              { (ipv4, ipv5) ->
                                                                               join {
                                                                                 $j1
-                                                                                  = case ipv16
-                                                                                    of wild19
+                                                                                  = case ipv4
+                                                                                    of wild23
                                                                                     { I# i3 ->
                                                                                     case <=# 0# i3
                                                                                     of {
                                                                                       __DEFAULT ->
-                                                                                        (# ipv13,
-                                                                                           lvl33 #);
+                                                                                        (# ww20,
+                                                                                           lvl49 #);
                                                                                       1# ->
                                                                                         case <=#
                                                                                                i3
                                                                                                locationGood
                                                                                         of {
                                                                                           __DEFAULT ->
-                                                                                            (# ipv13,
-                                                                                               lvl33 #);
+                                                                                            (# ww20,
+                                                                                               lvl49 #);
                                                                                           1# ->
-                                                                                            case ipv17
-                                                                                            of wild20
+                                                                                            case ipv5
+                                                                                            of wild24
                                                                                             { I# i5 ->
                                                                                             case <=#
                                                                                                    0#
                                                                                                    i5
                                                                                             of {
                                                                                               __DEFAULT ->
-                                                                                                (# ipv13,
-                                                                                                   lvl33 #);
+                                                                                                (# ww20,
+                                                                                                   lvl49 #);
                                                                                               1# ->
                                                                                                 case <=#
                                                                                                        i5
                                                                                                        locationGood1
                                                                                                 of {
                                                                                                   __DEFAULT ->
-                                                                                                    (# ipv13,
-                                                                                                       lvl33 #);
+                                                                                                    (# ww20,
+                                                                                                       lvl49 #);
                                                                                                   1# ->
                                                                                                     case $wreadSA
                                                                                                            ww10
@@ -3096,30 +4032,27 @@
                                                                                                            ww5
                                                                                                            i3
                                                                                                            i5
-                                                                                                           ipv13
+                                                                                                           ww20
                                                                                                     of
-                                                                                                    { (# ipv18,
-                                                                                                         ipv19 #) ->
-                                                                                                    case ipv19
-                                                                                                    of
-                                                                                                    { W8# ipv20 ->
+                                                                                                    { (# ww22,
+                                                                                                         ww23 #) ->
                                                                                                     case word8ToWord#
-                                                                                                           ipv20
+                                                                                                           ww23
                                                                                                     of {
                                                                                                       __DEFAULT ->
                                                                                                         case $wchain
                                                                                                                wild
                                                                                                                next1
-                                                                                                               wild19
-                                                                                                               wild20
-                                                                                                               ipv18
-                                                                                                        of ds9
-                                                                                                        { (# ipv21,
-                                                                                                             ipv22 #) ->
-                                                                                                        case ipv22
+                                                                                                               wild23
+                                                                                                               wild24
+                                                                                                               ww22
+                                                                                                        of ds4
+                                                                                                        { (# ipv6,
+                                                                                                             ipv7 #) ->
+                                                                                                        case ipv7
                                                                                                         of {
                                                                                                           Left e1 ->
-                                                                                                            ds9;
+                                                                                                            ds4;
                                                                                                           Right x1 ->
                                                                                                             case $wreadSA
                                                                                                                    ww10
@@ -3130,30 +4063,26 @@
                                                                                                                    ww5
                                                                                                                    i3
                                                                                                                    i5
-                                                                                                                   ipv21
+                                                                                                                   ipv6
                                                                                                             of
-                                                                                                            { (# ipv23,
-                                                                                                                 ipv24 #) ->
-                                                                                                            case ipv24
-                                                                                                            of
-                                                                                                            { W8# ipv25 ->
+                                                                                                            { (# ww24,
+                                                                                                                 ww25 #) ->
                                                                                                             case word8ToWord#
-                                                                                                                   ipv25
+                                                                                                                   ww25
                                                                                                             of {
                                                                                                               __DEFAULT ->
                                                                                                                 jump $s$wgo0
-                                                                                                                  ipv23
+                                                                                                                  ww24
                                                                                                                   sc1
                                                                                                                   sc2;
                                                                                                               1## ->
-                                                                                                                (# ipv23,
-                                                                                                                   lvl33 #);
+                                                                                                                (# ww24,
+                                                                                                                   lvl49 #);
                                                                                                               2## ->
-                                                                                                                (# ipv23,
-                                                                                                                   lvl33 #)
+                                                                                                                (# ww24,
+                                                                                                                   lvl49 #)
                                                                                                             }
                                                                                                             }
-                                                                                                            }
                                                                                                         }
                                                                                                         };
                                                                                                       0## ->
@@ -3171,9 +4100,9 @@
                                                                                                                      ww5
                                                                                                                      i3
                                                                                                                      i5
-                                                                                                                     ipv15
-                                                                                                                     ipv18
-                                                                                                              of ww14
+                                                                                                                     ww21
+                                                                                                                     ww22
+                                                                                                              of ww24
                                                                                                               { __DEFAULT ->
                                                                                                               case $wwriteSA
                                                                                                                      ww10
@@ -3185,11 +4114,11 @@
                                                                                                                      sc2
                                                                                                                      sc1
                                                                                                                      0#Word8
-                                                                                                                     ww14
-                                                                                                              of ww15
+                                                                                                                     ww24
+                                                                                                              of ww25
                                                                                                               { __DEFAULT ->
                                                                                                               jump $s$wgo0
-                                                                                                                ww15
+                                                                                                                ww25
                                                                                                                 i5
                                                                                                                 i3
                                                                                                               }
@@ -3212,7 +4141,7 @@
                                                                                                                 jump $j2;
                                                                                                               1# ->
                                                                                                                 case word8ToWord#
-                                                                                                                       ipv15
+                                                                                                                       ww21
                                                                                                                 of {
                                                                                                                   __DEFAULT ->
                                                                                                                     case <=#
@@ -3258,12 +4187,12 @@
                                                                                                                                     case readIntArray#
                                                                                                                                            ds2
                                                                                                                                            y
-                                                                                                                                           ipv18
+                                                                                                                                           ww22
                                                                                                                                     of
-                                                                                                                                    { (# ipv21,
-                                                                                                                                         ipv22 #) ->
+                                                                                                                                    { (# ipv6,
+                                                                                                                                         ipv7 #) ->
                                                                                                                                     case >#
-                                                                                                                                           ipv22
+                                                                                                                                           ipv7
                                                                                                                                            1#
                                                                                                                                     of {
                                                                                                                                       __DEFAULT ->
@@ -3283,10 +4212,10 @@
                                                                                                                                                                ~R# STRep
                                                                                                                                                                      s
                                                                                                                                                                      ())
-                                                                                                                                               ipv21
+                                                                                                                                               ipv6
                                                                                                                                         of
-                                                                                                                                        { (# ipv23,
-                                                                                                                                             ipv24 #) ->
+                                                                                                                                        { (# ipv8,
+                                                                                                                                             ipv9 #) ->
                                                                                                                                         case $wwriteSA
                                                                                                                                                ww10
                                                                                                                                                ww11
@@ -3297,11 +4226,11 @@
                                                                                                                                                sc2
                                                                                                                                                sc1
                                                                                                                                                0#Word8
-                                                                                                                                               ipv23
-                                                                                                                                        of ww14
+                                                                                                                                               ipv8
+                                                                                                                                        of ww24
                                                                                                                                         { __DEFAULT ->
-                                                                                                                                        (# ww14,
-                                                                                                                                           lvl35 #)
+                                                                                                                                        (# ww24,
+                                                                                                                                           lvl51 #)
                                                                                                                                         }
                                                                                                                                         };
                                                                                                                                       1# ->
@@ -3316,7 +4245,7 @@
                                                                                                                                                                          s)
                                                                                                                                                  (I#
                                                                                                                                                     (-#
-                                                                                                                                                       ipv22
+                                                                                                                                                       ipv7
                                                                                                                                                        1#)))
                                                                                                                                               `cast` <Co:3> :: ST
                                                                                                                                                                  s
@@ -3324,10 +4253,10 @@
                                                                                                                                                                ~R# STRep
                                                                                                                                                                      s
                                                                                                                                                                      ())
-                                                                                                                                               ipv21
+                                                                                                                                               ipv6
                                                                                                                                         of
-                                                                                                                                        { (# ipv23,
-                                                                                                                                             ipv24 #) ->
+                                                                                                                                        { (# ipv8,
+                                                                                                                                             ipv9 #) ->
                                                                                                                                         case $wwriteSA
                                                                                                                                                ww10
                                                                                                                                                ww11
@@ -3338,11 +4267,11 @@
                                                                                                                                                sc2
                                                                                                                                                sc1
                                                                                                                                                0#Word8
-                                                                                                                                               ipv23
-                                                                                                                                        of ww14
+                                                                                                                                               ipv8
+                                                                                                                                        of ww24
                                                                                                                                         { __DEFAULT ->
-                                                                                                                                        (# ww14,
-                                                                                                                                           lvl33 #)
+                                                                                                                                        (# ww24,
+                                                                                                                                           lvl49 #)
                                                                                                                                         }
                                                                                                                                         }
                                                                                                                                     }
@@ -3352,47 +4281,42 @@
                                                                                                                         }
                                                                                                                     };
                                                                                                                   1## ->
-                                                                                                                    (# ipv18,
-                                                                                                                       lvl32 #)
+                                                                                                                    (# ww22,
+                                                                                                                       lvl48 #)
                                                                                                                 }
                                                                                                             }
                                                                                                             }
                                                                                                         }
                                                                                                         };
                                                                                                       3## ->
-                                                                                                        (# ipv18,
-                                                                                                           lvl33 #)
+                                                                                                        (# ww22,
+                                                                                                           lvl49 #)
                                                                                                     }
                                                                                                     }
-                                                                                                    }
                                                                                                 }
                                                                                             }
                                                                                             }
                                                                                         }
                                                                                     }
                                                                                     } } in
-                                                                              case word8ToWord#
-                                                                                     ipv15
+                                                                              case word8ToWord# ww21
                                                                               of {
                                                                                 __DEFAULT ->
-                                                                                  (# ipv13,
-                                                                                     lvl33 #);
+                                                                                  (# ww20, lvl49 #);
                                                                                 1## -> jump $j1;
                                                                                 2## -> jump $j1
                                                                               }
                                                                               }
                                                                               }
-                                                                              }
                                                                           }
                                                                       }
                                                                   }
                                                               }; } in
-                                                        jump $s$wgo0 ipv10 i4 i;
-                                                      1## -> (# ipv10, lvl33 #);
-                                                      2## -> (# ipv10, lvl33 #)
+                                                        jump $s$wgo0 ww18 i4 i;
+                                                      1## -> (# ww18, lvl49 #);
+                                                      2## -> (# ww18, lvl49 #)
                                                     }
                                                     }
-                                                    }
                                                 }
                                                 };
                                               0## ->
@@ -3408,9 +4332,9 @@
                                                              ww5
                                                              i1
                                                              i2
-                                                             ipv2
-                                                             ipv5
-                                                      of ww14
+                                                             ww15
+                                                             ww16
+                                                      of ww18
                                                       { __DEFAULT ->
                                                       case $wwriteSA
                                                              ww10
@@ -3422,24 +4346,24 @@
                                                              i
                                                              i4
                                                              0#Word8
-                                                             ww14
-                                                      of ww15
+                                                             ww18
+                                                      of ww19
                                                       { __DEFAULT ->
                                                       joinrec {
                                                         $s$wgo0 sc sc1 sc2
                                                           = case <=# 0# sc2 of {
-                                                              __DEFAULT -> (# sc, lvl33 #);
+                                                              __DEFAULT -> (# sc, lvl49 #);
                                                               1# ->
                                                                 case <=# sc2 locationGood of {
-                                                                  __DEFAULT -> (# sc, lvl33 #);
+                                                                  __DEFAULT -> (# sc, lvl49 #);
                                                                   1# ->
                                                                     case <=# 0# sc1 of {
-                                                                      __DEFAULT -> (# sc, lvl33 #);
+                                                                      __DEFAULT -> (# sc, lvl49 #);
                                                                       1# ->
                                                                         case <=# sc1 locationGood1
                                                                         of {
                                                                           __DEFAULT ->
-                                                                            (# sc, lvl33 #);
+                                                                            (# sc, lvl49 #);
                                                                           1# ->
                                                                             case $wreadSA
                                                                                    ww10
@@ -3452,50 +4376,48 @@
                                                                                    sc1
                                                                                    sc
                                                                             of
-                                                                            { (# ipv8, ipv9 #) ->
-                                                                            case ipv9 of
-                                                                            { W8# ipv10 ->
+                                                                            { (# ww20, ww21 #) ->
                                                                             case next1
                                                                                    (I# sc2, I# sc1)
                                                                             of
-                                                                            { (ipv11, ipv12) ->
+                                                                            { (ipv2, ipv3) ->
                                                                             join {
                                                                               $j2
-                                                                                = case ipv11
-                                                                                  of wild18
+                                                                                = case ipv2
+                                                                                  of wild21
                                                                                   { I# i3 ->
                                                                                   case <=# 0# i3
                                                                                   of {
                                                                                     __DEFAULT ->
-                                                                                      (# ipv8,
-                                                                                         lvl33 #);
+                                                                                      (# ww20,
+                                                                                         lvl49 #);
                                                                                     1# ->
                                                                                       case <=#
                                                                                              i3
                                                                                              locationGood
                                                                                       of {
                                                                                         __DEFAULT ->
-                                                                                          (# ipv8,
-                                                                                             lvl33 #);
+                                                                                          (# ww20,
+                                                                                             lvl49 #);
                                                                                         1# ->
-                                                                                          case ipv12
-                                                                                          of wild19
+                                                                                          case ipv3
+                                                                                          of wild22
                                                                                           { I# i5 ->
                                                                                           case <=#
                                                                                                  0#
                                                                                                  i5
                                                                                           of {
                                                                                             __DEFAULT ->
-                                                                                              (# ipv8,
-                                                                                                 lvl33 #);
+                                                                                              (# ww20,
+                                                                                                 lvl49 #);
                                                                                             1# ->
                                                                                               case <=#
                                                                                                      i5
                                                                                                      locationGood1
                                                                                               of {
                                                                                                 __DEFAULT ->
-                                                                                                  (# ipv8,
-                                                                                                     lvl33 #);
+                                                                                                  (# ww20,
+                                                                                                     lvl49 #);
                                                                                                 1# ->
                                                                                                   case $wreadSA
                                                                                                          ww10
@@ -3506,30 +4428,27 @@
                                                                                                          ww5
                                                                                                          i3
                                                                                                          i5
-                                                                                                         ipv8
+                                                                                                         ww20
                                                                                                   of
-                                                                                                  { (# ipv13,
-                                                                                                       ipv14 #) ->
-                                                                                                  case ipv14
-                                                                                                  of
-                                                                                                  { W8# ipv15 ->
+                                                                                                  { (# ww22,
+                                                                                                       ww23 #) ->
                                                                                                   case word8ToWord#
-                                                                                                         ipv15
+                                                                                                         ww23
                                                                                                   of {
                                                                                                     __DEFAULT ->
                                                                                                       case $wchain
                                                                                                              wild
                                                                                                              next1
-                                                                                                             wild18
-                                                                                                             wild19
-                                                                                                             ipv13
-                                                                                                      of ds7
-                                                                                                      { (# ipv16,
-                                                                                                           ipv17 #) ->
-                                                                                                      case ipv17
+                                                                                                             wild21
+                                                                                                             wild22
+                                                                                                             ww22
+                                                                                                      of ds1
+                                                                                                      { (# ipv4,
+                                                                                                           ipv5 #) ->
+                                                                                                      case ipv5
                                                                                                       of {
                                                                                                         Left e1 ->
-                                                                                                          ds7;
+                                                                                                          ds1;
                                                                                                         Right x ->
                                                                                                           case $wreadSA
                                                                                                                  ww10
@@ -3540,30 +4459,26 @@
                                                                                                                  ww5
                                                                                                                  i3
                                                                                                                  i5
-                                                                                                                 ipv16
+                                                                                                                 ipv4
                                                                                                           of
-                                                                                                          { (# ipv18,
-                                                                                                               ipv19 #) ->
-                                                                                                          case ipv19
-                                                                                                          of
-                                                                                                          { W8# ipv20 ->
+                                                                                                          { (# ww24,
+                                                                                                               ww25 #) ->
                                                                                                           case word8ToWord#
-                                                                                                                 ipv20
+                                                                                                                 ww25
                                                                                                           of {
                                                                                                             __DEFAULT ->
                                                                                                               jump $s$wgo0
-                                                                                                                ipv18
+                                                                                                                ww24
                                                                                                                 sc1
                                                                                                                 sc2;
                                                                                                             1## ->
-                                                                                                              (# ipv18,
-                                                                                                                 lvl33 #);
+                                                                                                              (# ww24,
+                                                                                                                 lvl49 #);
                                                                                                             2## ->
-                                                                                                              (# ipv18,
-                                                                                                                 lvl33 #)
+                                                                                                              (# ww24,
+                                                                                                                 lvl49 #)
                                                                                                           }
                                                                                                           }
-                                                                                                          }
                                                                                                       }
                                                                                                       };
                                                                                                     0## ->
@@ -3578,9 +4493,9 @@
                                                                                                                    ww5
                                                                                                                    i3
                                                                                                                    i5
-                                                                                                                   ipv10
-                                                                                                                   ipv13
-                                                                                                            of ww16
+                                                                                                                   ww21
+                                                                                                                   ww22
+                                                                                                            of ww24
                                                                                                             { __DEFAULT ->
                                                                                                             case $wwriteSA
                                                                                                                    ww10
@@ -3592,11 +4507,11 @@
                                                                                                                    sc2
                                                                                                                    sc1
                                                                                                                    0#Word8
-                                                                                                                   ww16
-                                                                                                            of ww17
+                                                                                                                   ww24
+                                                                                                            of ww25
                                                                                                             { __DEFAULT ->
                                                                                                             jump $s$wgo0
-                                                                                                              ww17
+                                                                                                              ww25
                                                                                                               i5
                                                                                                               i3
                                                                                                             }
@@ -3619,7 +4534,7 @@
                                                                                                               jump $j3;
                                                                                                             1# ->
                                                                                                               case word8ToWord#
-                                                                                                                     ipv10
+                                                                                                                     ww21
                                                                                                               of {
                                                                                                                 __DEFAULT ->
                                                                                                                   case <=#
@@ -3665,12 +4580,12 @@
                                                                                                                                   case readIntArray#
                                                                                                                                          ds2
                                                                                                                                          y
-                                                                                                                                         ipv13
+                                                                                                                                         ww22
                                                                                                                                   of
-                                                                                                                                  { (# ipv16,
-                                                                                                                                       ipv17 #) ->
+                                                                                                                                  { (# ipv4,
+                                                                                                                                       ipv5 #) ->
                                                                                                                                   case >#
-                                                                                                                                         ipv17
+                                                                                                                                         ipv5
                                                                                                                                          1#
                                                                                                                                   of {
                                                                                                                                     __DEFAULT ->
@@ -3690,10 +4605,10 @@
                                                                                                                                                              ~R# STRep
                                                                                                                                                                    s
                                                                                                                                                                    ())
-                                                                                                                                             ipv16
+                                                                                                                                             ipv4
                                                                                                                                       of
-                                                                                                                                      { (# ipv18,
-                                                                                                                                           ipv19 #) ->
+                                                                                                                                      { (# ipv6,
+                                                                                                                                           ipv7 #) ->
                                                                                                                                       case $wwriteSA
                                                                                                                                              ww10
                                                                                                                                              ww11
@@ -3704,11 +4619,11 @@
                                                                                                                                              sc2
                                                                                                                                              sc1
                                                                                                                                              0#Word8
-                                                                                                                                             ipv18
-                                                                                                                                      of ww16
+                                                                                                                                             ipv6
+                                                                                                                                      of ww24
                                                                                                                                       { __DEFAULT ->
-                                                                                                                                      (# ww16,
-                                                                                                                                         lvl35 #)
+                                                                                                                                      (# ww24,
+                                                                                                                                         lvl51 #)
                                                                                                                                       }
                                                                                                                                       };
                                                                                                                                     1# ->
@@ -3723,7 +4638,7 @@
                                                                                                                                                                        s)
                                                                                                                                                (I#
                                                                                                                                                   (-#
-                                                                                                                                                     ipv17
+                                                                                                                                                     ipv5
                                                                                                                                                      1#)))
                                                                                                                                             `cast` <Co:3> :: ST
                                                                                                                                                                s
@@ -3731,10 +4646,10 @@
                                                                                                                                                              ~R# STRep
                                                                                                                                                                    s
                                                                                                                                                                    ())
-                                                                                                                                             ipv16
+                                                                                                                                             ipv4
                                                                                                                                       of
-                                                                                                                                      { (# ipv18,
-                                                                                                                                           ipv19 #) ->
+                                                                                                                                      { (# ipv6,
+                                                                                                                                           ipv7 #) ->
                                                                                                                                       case $wwriteSA
                                                                                                                                              ww10
                                                                                                                                              ww11
@@ -3745,11 +4660,11 @@
                                                                                                                                              sc2
                                                                                                                                              sc1
                                                                                                                                              0#Word8
-                                                                                                                                             ipv18
-                                                                                                                                      of ww16
+                                                                                                                                             ipv6
+                                                                                                                                      of ww24
                                                                                                                                       { __DEFAULT ->
-                                                                                                                                      (# ww16,
-                                                                                                                                         lvl33 #)
+                                                                                                                                      (# ww24,
+                                                                                                                                         lvl49 #)
                                                                                                                                       }
                                                                                                                                       }
                                                                                                                                   }
@@ -3759,39 +4674,37 @@
                                                                                                                       }
                                                                                                                   };
                                                                                                                 1## ->
-                                                                                                                  (# ipv13,
-                                                                                                                     lvl32 #)
+                                                                                                                  (# ww22,
+                                                                                                                     lvl48 #)
                                                                                                               }
                                                                                                           }
                                                                                                           }
                                                                                                       };
                                                                                                     3## ->
-                                                                                                      (# ipv13,
-                                                                                                         lvl33 #)
+                                                                                                      (# ww22,
+                                                                                                         lvl49 #)
                                                                                                   }
                                                                                                   }
-                                                                                                  }
                                                                                               }
                                                                                           }
                                                                                           }
                                                                                       }
                                                                                   }
                                                                                   } } in
-                                                                            case word8ToWord# ipv10
+                                                                            case word8ToWord# ww21
                                                                             of {
                                                                               __DEFAULT ->
-                                                                                (# ipv8, lvl33 #);
+                                                                                (# ww20, lvl49 #);
                                                                               1## -> jump $j2;
                                                                               2## -> jump $j2
                                                                             }
                                                                             }
                                                                             }
-                                                                            }
                                                                         }
                                                                     }
                                                                 }
                                                             }; } in
-                                                      jump $s$wgo0 ww15 i2 i1
+                                                      jump $s$wgo0 ww19 i2 i1
                                                       }
                                                       } } in
                                                 case ==# i1 y1 of {
@@ -3801,7 +4714,7 @@
                                                     case ==# i2 y2 of {
                                                       __DEFAULT -> jump $j1;
                                                       1# ->
-                                                        case word8ToWord# ipv2 of {
+                                                        case word8ToWord# ww15 of {
                                                           __DEFAULT ->
                                                             case <=# m 0# of {
                                                               __DEFAULT -> case moveGame7 m n of {};
@@ -3820,10 +4733,10 @@
                                                                             of {};
                                                                           1# ->
                                                                             case readIntArray#
-                                                                                   ds2 y ipv5
+                                                                                   ds2 y ww16
                                                                             of
-                                                                            { (# ipv8, ipv9 #) ->
-                                                                            case ># ipv9 1# of {
+                                                                            { (# ipv2, ipv3 #) ->
+                                                                            case ># ipv3 1# of {
                                                                               __DEFAULT ->
                                                                                 case ((writeIR
                                                                                          $fMArraySTUArrayIntST
@@ -3841,10 +4754,10 @@
                                                                                                        ~R# STRep
                                                                                                              s
                                                                                                              ())
-                                                                                       ipv8
+                                                                                       ipv2
                                                                                 of
-                                                                                { (# ipv10,
-                                                                                     ipv11 #) ->
+                                                                                { (# ipv4,
+                                                                                     ipv5 #) ->
                                                                                 case $wwriteSA
                                                                                        ww10
                                                                                        ww11
@@ -3855,10 +4768,10 @@
                                                                                        i
                                                                                        i4
                                                                                        0#Word8
-                                                                                       ipv10
-                                                                                of ww14
+                                                                                       ipv4
+                                                                                of ww18
                                                                                 { __DEFAULT ->
-                                                                                (# ww14, lvl35 #)
+                                                                                (# ww18, lvl51 #)
                                                                                 }
                                                                                 };
                                                                               1# ->
@@ -3873,7 +4786,7 @@
                                                                                                                  s)
                                                                                          (I#
                                                                                             (-#
-                                                                                               ipv9
+                                                                                               ipv3
                                                                                                1#)))
                                                                                       `cast` <Co:3> :: ST
                                                                                                          s
@@ -3881,10 +4794,10 @@
                                                                                                        ~R# STRep
                                                                                                              s
                                                                                                              ())
-                                                                                       ipv8
+                                                                                       ipv2
                                                                                 of
-                                                                                { (# ipv10,
-                                                                                     ipv11 #) ->
+                                                                                { (# ipv4,
+                                                                                     ipv5 #) ->
                                                                                 case $wwriteSA
                                                                                        ww10
                                                                                        ww11
@@ -3895,10 +4808,10 @@
                                                                                        i
                                                                                        i4
                                                                                        0#Word8
-                                                                                       ipv10
-                                                                                of ww14
+                                                                                       ipv4
+                                                                                of ww18
                                                                                 { __DEFAULT ->
-                                                                                (# ww14, lvl33 #)
+                                                                                (# ww18, lvl49 #)
                                                                                 }
                                                                                 }
                                                                             }
@@ -3907,24 +4820,23 @@
                                                                     }
                                                                 }
                                                             };
-                                                          1## -> (# ipv5, lvl32 #)
+                                                          1## -> (# ww16, lvl48 #)
                                                         }
                                                     }
                                                     }
                                                 }
                                                 };
-                                              3## -> (# ipv5, lvl33 #)
+                                              3## -> (# ww16, lvl49 #)
                                             }
                                             }
-                                            }
                                         }
                                     }
                                     }
                                 }
                             }
                             } } in
-                      case word8ToWord# ipv2 of {
-                        __DEFAULT -> (# ipv, lvl33 #);
+                      case word8ToWord# ww15 of {
+                        __DEFAULT -> (# ww14, lvl49 #);
                         1## -> jump $j;
                         2## -> jump $j
                       }
@@ -3934,7 +4846,6 @@
                       }
                       }
                       }
-                      }
                   }
               }
               }
@@ -3981,7 +4892,7 @@
                join {
                  exit s2#
                    = let { nt = STUArray moveGame8 moveGame8 1# ipv3 } in
-                     let { lvl34 = -# bx2 1# } in
+                     let { lvl50 = -# bx2 1# } in
                      let { conrep = STUArray l u bx3 ipv1 } in
                      let {
                        mgame
@@ -4037,14 +4948,14 @@
                          = case sc of { () ->
                            case unsafeFreezeByteArray# ipv1 sc1 of { (# s2#1, arr#1 #) ->
                            case $w$sreadIR 0# 0# 1# ipv3 s2#1 of { (# ww, ww1 #) ->
-                           case ww1 of ds7 {
+                           case ww1 of wild6 {
                              __DEFAULT ->
                                Right
                                  (Game
                                     ((UArray l u bx3 arr#1)
                                      `cast` <Co:2> :: UArray (Int, Int) Word ~R# IA)
                                     target
-                                    ds7
+                                    wild6
                                     bx1
                                     bx2);
                              0# ->
@@ -4068,7 +4979,7 @@
                              1# ->
                                joinrec {
                                  $sgo1 sc2 sc3
-                                   = case <=# sc3 lvl34 of {
+                                   = case <=# sc3 lvl50 of {
                                        __DEFAULT -> jump $sgo sc2 (+# sc1 1#);
                                        1# ->
                                          case $wchain mgame next1 (I# sc1) (I# sc3) sc2 of
@@ -4162,7 +5073,7 @@
                                          = case newByteArray# 8# ipv4 of { (# ipv5, ipv6 #) ->
                                            join {
                                              exit s2#
-                                               = let { lvl34 = -# ww1 1# } in
+                                               = let { lvl50 = -# ww1 1# } in
                                                  join {
                                                    $w$j1 ipv7
                                                      = case unsafeFreezeByteArray# ipv3 ipv7 of
@@ -4180,7 +5091,7 @@
                                                          1# ->
                                                            joinrec {
                                                              $sgo1 sc2 sc3
-                                                               = case <=# sc3 lvl34 of {
+                                                               = case <=# sc3 lvl50 of {
                                                                    __DEFAULT ->
                                                                      jump $sgo sc2 (+# sc1 1#);
                                                                    1# ->
@@ -4266,7 +5177,7 @@
                                          jump go3 0# ipv2;
                                        1# -> jump $w$j ipv2
                                      };
-                                   1# -> case lvl30 of {}
+                                   1# -> case lvl46 of {}
                                  } } in
                            case <=# 0# bounds' of {
                              __DEFAULT -> jump $j2 0#;
