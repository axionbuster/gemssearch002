Test case 1:
yes
Initial state:
......
.@....
......
......
..*...
......
......
.#.%@.

Step 1: Apply gravity DirUp
.@.%@.
......
......
......
..*...
......
......
.#....

Step 2: Apply gravity DirLeft
@%@...
......
......
......
..*...
......
......
.#....

Step 3: Apply gravity DirDown
......
......
......
......
..*...
......
.%....
@#....

Step 4: Apply gravity DirUp
@%....
......
......
......
..*...
......
......
.#....

Step 5: Apply gravity DirRight
....@%
......
......
......
..*...
......
......
.#....

Step 6: Apply gravity DirDown
......
......
......
......
..*...
......
......
.#..@%

Step 7: Apply gravity DirLeft
......
......
......
......
..*...
......
......
.#@%..

Step 8: Apply gravity DirUp
......
......
......
......
..*...
......
......
.#.%..

Won!
Test case 2:
yes
Initial state:
..#%%#
......
......
......
..*...
......
......
@%...#

Step 1: Apply gravity DirRight
..#%%#
......
......
......
..*...
......
......
...@%#

Step 2: Apply gravity DirDown
..#..#
......
......
......
..*...
......
...%%.
...@%#

Step 3: Apply gravity DirRight
..#..#
......
......
......
..*...
......
....%%
...@%#

Step 4: Apply gravity DirUp
..#@%#
....%%
......
......
..*...
......
......
.....#

Step 5: Apply gravity DirLeft
..#@%#
%%....
......
......
..*...
......
......
.....#

Step 6: Apply gravity DirDown
..#..#
......
......
......
..*...
......
......
%%.@%#

Step 7: Apply gravity DirLeft
..#..#
......
......
......
..*...
......
......
%%@%.#

Step 8: Apply gravity DirUp
%%#..#
......
......
......
..*...
......
......
...%.#

Won!
Test case 3:
yes
Initial state:
.###.#
......
...*..
......
......
......
.....@
.....%

Step 1: Apply gravity DirLeft
.###.#
......
...*..
......
......
......
@.....
%.....

Step 2: Apply gravity DirUp
@###.#
%.....
...*..
......
......
......
......
......

Step 3: Apply gravity DirRight
@###.#
.....%
...*..
......
......
......
......
......

Step 4: Apply gravity DirDown
.###.#
......
...*..
......
......
......
......
@....%

Step 5: Apply gravity DirRight
.###.#
......
...*..
......
......
......
......
....@%

Step 6: Apply gravity DirUp
.###@#
.....%
...*..
......
......
......
......
......

Step 7: Apply gravity DirLeft
.###@#
%.....
...*..
......
......
......
......
......

Step 8: Apply gravity DirDown
.###.#
......
...*..
......
......
......
......
%...@.

Step 9: Apply gravity DirLeft
.###.#
......
...*..
......
......
......
......
%@....

Step 10: Apply gravity DirUp
%###.#
.@....
...*..
......
......
......
......
......

Step 11: Apply gravity DirLeft
%###.#
@.....
...*..
......
......
......
......
......

Step 12: Apply gravity DirDown
.###.#
......
...*..
......
......
......
%.....
@.....

Step 13: Apply gravity DirRight
.###.#
......
...*..
......
......
......
.....%
.....@

Step 14: Apply gravity DirUp
.###.#
.....%
...*.@
......
......
......
......
......

Step 15: Apply gravity DirLeft
.###.#
%.....
...*..
......
......
......
......
......

Won!
Test case 4:
yes
Initial state:
.......#
.....#..
.....#.#
#####*.#
........
%@.....#

Step 1: Apply gravity DirUp
.......#
.....#..
.....#.#
#####*.#
%@......
.......#

Step 2: Apply gravity DirRight
.......#
.....#..
.....#.#
#####*.#
......%@
.......#

Step 3: Apply gravity DirUp
......%#
.....#..
.....#.#
#####*.#
.......@
.......#

Step 4: Apply gravity DirLeft
%......#
.....#..
.....#.#
#####*.#
@.......
.......#

Step 5: Apply gravity DirDown
.......#
.....#..
%....#.#
#####*.#
........
@......#

Step 6: Apply gravity DirRight
.......#
.....#..
....%#.#
#####*.#
........
......@#

Step 7: Apply gravity DirUp
....%.@#
.....#..
.....#.#
#####*.#
........
.......#

Step 8: Apply gravity DirRight
.....%@#
.....#..
.....#.#
#####*.#
........
.......#

Step 9: Apply gravity DirDown
.....%.#
.....#..
.....#.#
#####*.#
........
......@#

Step 10: Apply gravity DirRight
......%#
.....#..
.....#.#
#####*.#
........
......@#

Step 11: Apply gravity DirDown
.......#
.....#..
.....#.#
#####*.#
......%.
......@#

Step 12: Apply gravity DirRight
.......#
.....#..
.....#.#
#####*.#
.......%
......@#

Step 13: Apply gravity DirUp
......@#
.....#..
.....#.#
#####*.#
.......%
.......#

Step 14: Apply gravity DirLeft
@......#
.....#..
.....#.#
#####*.#
%.......
.......#

Step 15: Apply gravity DirDown
.......#
.....#..
@....#.#
#####*.#
........
%......#

Step 16: Apply gravity DirRight
.......#
.....#..
....@#.#
#####*.#
........
......%#

Step 17: Apply gravity DirUp
....@.%#
.....#..
.....#.#
#####*.#
........
.......#

Step 18: Apply gravity DirRight
.....@%#
.....#..
.....#.#
#####*.#
........
.......#

Step 19: Apply gravity DirDown
.....@.#
.....#..
.....#.#
#####*.#
........
......%#

Step 20: Apply gravity DirRight
......@#
.....#..
.....#.#
#####*.#
........
......%#

Step 21: Apply gravity DirUp
......@#
.....#%.
.....#.#
#####*.#
........
.......#

Step 22: Apply gravity DirRight
......@#
.....#.%
.....#.#
#####*.#
........
.......#

Step 23: Apply gravity DirDown
.......#
.....#.%
.....#.#
#####*.#
........
......@#

Step 24: Apply gravity DirLeft
.......#
.....#%.
.....#.#
#####*.#
........
@......#

Step 25: Apply gravity DirDown
.......#
.....#..
.....#.#
#####*.#
........
@.....%#

Step 26: Apply gravity DirRight
.......#
.....#..
.....#.#
#####*.#
........
.....@%#

Step 27: Apply gravity DirUp
.......#
.....#..
.....#.#
#####*.#
........
......%#

Won!
Test case 5:
yes
Initial state:
......
......
......
......
...*.%
...#.@
..#..#
.#####

Step 1: Apply gravity DirUp
.....%
.....@
......
......
...*..
...#..
..#..#
.#####

Step 2: Apply gravity DirLeft
%.....
@.....
......
......
...*..
...#..
..#..#
.#####

Step 3: Apply gravity DirDown
......
......
......
......
...*..
...#..
%.#..#
@#####

Step 4: Apply gravity DirRight
......
......
......
......
...*..
...#..
.%#..#
@#####

Step 5: Apply gravity DirUp
@%....
......
......
......
...*..
...#..
..#..#
.#####

Step 6: Apply gravity DirRight
....@%
......
......
......
...*..
...#..
..#..#
.#####

Step 7: Apply gravity DirDown
......
......
......
......
...*..
...#.%
..#.@#
.#####

Step 8: Apply gravity DirLeft
......
......
......
......
...*..
...#%.
..#@.#
.#####

Step 9: Apply gravity DirUp
....%.
......
......
......
...*..
...#..
..#@.#
.#####

Step 10: Apply gravity DirLeft
%.....
......
......
......
...*..
...#..
..#@.#
.#####

Step 11: Apply gravity DirDown
......
......
......
......
...*..
...#..
..#@.#
%#####

Step 12: Apply gravity DirRight
......
......
......
......
...*..
...#..
..#.@#
%#####

Step 13: Apply gravity DirUp
%...@.
......
......
......
...*..
...#..
..#..#
.#####

Step 14: Apply gravity DirLeft
%@....
......
......
......
...*..
...#..
..#..#
.#####

Step 15: Apply gravity DirDown
......
......
......
......
...*..
...#..
.@#..#
%#####

Step 16: Apply gravity DirLeft
......
......
......
......
...*..
...#..
@.#..#
%#####

Step 17: Apply gravity DirUp
@.....
%.....
......
......
...*..
...#..
..#..#
.#####

Step 18: Apply gravity DirRight
.....@
.....%
......
......
...*..
...#..
..#..#
.#####

Step 19: Apply gravity DirDown
......
......
......
......
...*.@
...#.%
..#..#
.#####

Step 20: Apply gravity DirLeft
......
......
......
......
...*..
...#.%
..#..#
.#####

Won!
Test case 6:
yes
Initial state:
@@...
%%...
#.*#.
.##..
.....

Step 1: Apply gravity DirRight
...@@
...%%
#.*#.
.##..
.....

Step 2: Apply gravity DirDown
...@.
...%.
#.*#.
.##.@
....%

Step 3: Apply gravity DirRight
....@
....%
#.*#.
.##.@
....%

Step 4: Apply gravity DirUp
....@
....%
#.*#@
.##.%
.....

Step 5: Apply gravity DirLeft
@....
%....
#.*#@
.##%.
.....

Step 6: Apply gravity DirUp
@...@
%....
#.*#.
.##%.
.....

Step 7: Apply gravity DirRight
...@@
....%
#.*#.
.##.%
.....

Step 8: Apply gravity DirDown
.....
...@.
#.*#@
.##.%
....%

Step 9: Apply gravity DirRight
.....
....@
#.*#@
.##.%
....%

Step 10: Apply gravity DirUp
....@
....@
#.*#%
.##.%
.....

Step 11: Apply gravity DirLeft
@....
@....
#.*#%
.##%.
.....

Step 12: Apply gravity DirUp
@...%
@....
#.*#.
.##%.
.....

Step 13: Apply gravity DirRight
...@%
....@
#.*#.
.##.%
.....

Step 14: Apply gravity DirUp
...@%
....@
#.*#%
.##..
.....

Step 15: Apply gravity DirLeft
@%...
@....
#.*#%
.##..
.....

Step 16: Apply gravity DirUp
@%..%
@....
#.*#.
.##..
.....

Step 17: Apply gravity DirRight
..@%%
....@
#.*#.
.##..
.....

Step 18: Apply gravity DirDown
.....
...%.
#.*#.
.##.%
....@

Step 19: Apply gravity DirRight
.....
....%
#.*#.
.##.%
....@

Step 20: Apply gravity DirUp
....%
....%
#.*#@
.##..
.....

Step 21: Apply gravity DirLeft
%....
%....
#.*#@
.##..
.....

Step 22: Apply gravity DirUp
%...@
%....
#.*#.
.##..
.....

Step 23: Apply gravity DirLeft
%@...
%....
#.*#.
.##..
.....

Step 24: Apply gravity DirDown
%....
%....
#@*#.
.##..
.....

Step 25: Apply gravity DirRight
....%
....%
#.*#.
.##..
.....

Won!
Test case 7:
yes
Initial state:
#%...
@.#..
%.*..
..#..
..#..
..#..

Step 1: Apply gravity DirDown
#....
..#..
..*..
..#..
@.#..
%%#..

Step 2: Apply gravity DirRight
#....
..#..
..*..
..#..
.@#..
%%#..

Step 3: Apply gravity DirUp
#@...
%%#..
..*..
..#..
..#..
..#..

Step 4: Apply gravity DirRight
#...@
%%#..
..*..
..#..
..#..
..#..

Step 5: Apply gravity DirUp
#%..@
%.#..
..*..
..#..
..#..
..#..

Step 6: Apply gravity DirRight
#..%@
.%#..
..*..
..#..
..#..
..#..

Step 7: Apply gravity DirUp
#%.%@
..#..
..*..
..#..
..#..
..#..

Step 8: Apply gravity DirRight
#.%%@
..#..
..*..
..#..
..#..
..#..

Step 9: Apply gravity DirDown
#.%..
..#..
..*..
..#..
..#..
..#%@

Step 10: Apply gravity DirRight
#...%
..#..
..*..
..#..
..#..
..#%@

Step 11: Apply gravity DirDown
#....
..#..
..*..
..#..
..#.%
..#%@

Step 12: Apply gravity DirLeft
#....
..#..
..*..
..#..
..#%.
..#%@

Step 13: Apply gravity DirUp
#..%@
..#%.
..*..
..#..
..#..
..#..

Step 14: Apply gravity DirRight
#..%@
..#.%
..*..
..#..
..#..
..#..

Step 15: Apply gravity DirDown
#....
..#..
..*..
..#..
..#.@
..#%%

Step 16: Apply gravity DirLeft
#....
..#..
..*..
..#..
..#@.
..#%%

Step 17: Apply gravity DirUp
#..@%
..#%.
..*..
..#..
..#..
..#..

Step 18: Apply gravity DirLeft
#@%..
..#%.
..*..
..#..
..#..
..#..

Step 19: Apply gravity DirDown
#.%..
..#..
..*..
..#..
..#..
.@#%.

Step 20: Apply gravity DirLeft
#%...
..#..
..*..
..#..
..#..
@.#%.

Step 21: Apply gravity DirUp
#%.%.
@.#..
..*..
..#..
..#..
..#..

Step 22: Apply gravity DirLeft
#%%..
@.#..
..*..
..#..
..#..
..#..

Step 23: Apply gravity DirDown
#.%..
..#..
..*..
..#..
..#..
@%#..

Step 24: Apply gravity DirLeft
#%...
..#..
..*..
..#..
..#..
@%#..

Step 25: Apply gravity DirDown
#....
..#..
..*..
..#..
.%#..
@%#..

Step 26: Apply gravity DirLeft
#....
..#..
..*..
..#..
%.#..
@%#..

Step 27: Apply gravity DirUp
#%...
%.#..
@.*..
..#..
..#..
..#..

Step 28: Apply gravity DirRight
#...%
.%#..
..*..
..#..
..#..
..#..

Won!
